@model List<ACMWeb.Models.UserViewModel.UserViewModel>
@{
    ViewData["Title"] = "User Management";
    Layout = "_LoggedInLayout";
}


<h2>Manage Admin User</h2>

<div id="divList">

</div>
@section Scripts
    {
<script type="text/javascript">
    $(function()
    {
    List();
    });
    function List() {
        $.ajax({
            method: "get",
            url: "@Url.Action("PartialList", "Usermanagement")",
            success: function (result) {
                $('#divList').html(result);
            },
            error: function (err) {
                console.log(err);
            }
        });
        }
        function EditAdminUser(id) {

          $.ajax({
            method: "get",
            url: "@Url.Action("EditAdminUser", "Usermanagement")",
               data: { id: id},
            success: function (result) {
                $('#divList').html(result);
            },
            error: function (err) {
                console.log(err);
            }
           });

        }
        function PasswordView(id, status) {
            var stat = status == "Active" ? "Deactive" : "Active";
            if (confirm("Are you sure you wish to " + stat+" this user?")) {
                 $.ajax({
                     method: "get",
                     url: "@Url.Action("PassswordView", "Usermanagement")",
                     data: {
                         id: id, status: status },
                     success: function (result) {

                         $('#divList').html(result);

                     },
                     error: function (err) {
                         console.log(err);
                     }
                 });
             }
             else {
                 return false;
             }
        }
        function StatusChanged() {
            var stat = $('#txtstatus').val() == "Active" ? "Suspended" : "Active";
            var txtid = $('#txtid').val();
            var txtstatus = $('#txtstatus').val();
            if (confirm("Are you sure you want to "+stat+" this?")) {
                $.ajax({
            method: "post",
            url: "@Url.Action("PassswordView", "Usermanagement")",
                    data: { id: $('#txtid').val(), status: $('#txtstatus').val(), password: $('#txtpassword').val()},
                    success: function (result) {
                        var test ="@ViewData["tryagain"]";
                        console.log(test);
                        if (result=="false") {
                             if (confirm("The password entered is incorrect Try Again")) {
                                 $.ajax({
                     method: "get",
                     url: "@Url.Action("PassswordView", "Usermanagement")",
                     data: {
                         id: txtid, status: txtstatus },
                     success: function (result) {

                         $('#divList').html(result);

                     },
                     error: function (err) {
                         console.log(err);
                     }
                 });
                                 }
                         else {

                                 window.location.href = "@Url.Action("Index", "Usermanagement")";
                         }

                         }
                         else{
                         $('#divList').html(result);
                     }

            },
            error: function (err) {
                console.log(err);
            }
        });
            }
            else {
                return false;
            }
        //alert(123)

    }
</script>
}